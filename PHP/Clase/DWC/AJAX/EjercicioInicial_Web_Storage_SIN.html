<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Ejemplo Web Storage</title>
	<style>
		div {
			border: 2px solid blue;
			margin: 2em;
			padding: 1em;
		}
	</style>
	<script type="text/javascript">
		function storageAvailable(type) {
			try {
				var storage = window[type],
					x = "__storage_test__";
				storage.setItem(x, x);
				storage.removeItem(x);
				return true;
			} catch (e) {
				return (
					e instanceof DOMException &&
					// everything except Firefox
					(e.code === 22 ||
						// Firefox
						e.code === 1014 ||
						// test name field too, because code might not be present
						// everything except Firefox
						e.name === "QuotaExceededError" ||
						// Firefox
						e.name === "NS_ERROR_DOM_QUOTA_REACHED") &&
					// acknowledge QuotaExceededError only if there's something already stored
					storage.length !== 0
				);
			}
		}
		function guardarDato() {
			var etiqueta = document.getElementById("etiqueta").value;
			var dato = document.getElementById("dato").value;
			localStorage.setItem(etiqueta, dato);
		}
		function mostrarDato() {
			var etiqueta = document.getElementById("etiqueta").value;
			var dato = localStorage.getItem(etiqueta);
			document.getElementById("sal").innerHTML = dato;
		}
		function mostrarContenido() {
			var contenido = "";
			for (var i = 0; i < localStorage.length; i++) {
				var clave = localStorage.key(i);
				var valor = localStorage.getItem(clave);
				contenido += clave + " : " + valor + "<br>";
			}
			document.getElementById("contenido").innerHTML = contenido;
		}
		function borrarDato() {
			var etiqueta = document.getElementById("etiqueta").value;
			localStorage.removeItem(etiqueta);
		}
		function borrarTodo() {
			localStorage.clear();
		}

		function contarVisitas() {
			if (localStorage.getItem("visitas") === null) {
				localStorage.setItem("visitas", 1);
			} else {
				var n = parseInt(localStorage.getItem("visitas"));
				n++;
				localStorage.setItem("visitas", n);
			}
			document.getElementById("nvisitas").innerHTML = "Número de visitas: " + localStorage.getItem("visitas");
		}


		document.addEventListener("DOMContentLoaded", function () {
			document.getElementById("btGuardar").addEventListener("click", guardarDato);
			document.getElementById("btMostrar").addEventListener("click", mostrarDato);
			document.getElementById("btContenido").addEventListener("click", mostrarContenido);
			document.getElementById("btBorrarDato").addEventListener("click", borrarDato);
			document.getElementById("btBorrarTodo").addEventListener("click", borrarTodo);
			contarVisitas();
		});
	</script>
</head>

<body>

	<h3>Esto es un ejemplo de Web Storage</h3>

	<label>Nombre: </label>
	<input type="text" name="etiqueta" id="etiqueta">
	<br><br>
	<label>Dato: </label>
	<input type="text" name="dato" id="dato">
	<br /><br />

	<hr>
	<br><br>
	<button id="btGuardar">Guardar Dato</button>
	<button id="btMostrar">Mostrar Dato</button>
	<button id="btContenido">Contenido del Web Storage</button>

	<button id="btBorrarDato">Borrar Dato</button>
	<button id="btBorrarTodo">Borrar Todo</button>

	<p>
	<div id="sal">
		Aquí ponemos el dato leído del localStorage
	</div>
	<div id="nvisitas">
		Aquí se muestra el número de visitas
	</div>
	</p>
	<p>
	<div id="contenido">
		Contenido de todo el Web Storage
	</div>
	</p>

</body>

</html>